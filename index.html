<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLP-1 Therapy Management Tool</title>
    <style>
        :root {
            --primary: #6200ea;
            --primary-dark: #3700b3;
            --secondary: #03dac6;
            --error: #cf6679;
            --background: #121212;
            --surface: #1e1e1e;
            --on-surface: #e0e0e0;
            --warning: #ffab00;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background);
            color: var(--on-surface);
            margin: 0;
            padding: 20px;
            max-width: 900px;
            margin: auto;
            line-height: 1.6;
        }

        h1, h2, h3, h4 {
            color: white;
            margin-top: 1.5em;
        }

        .disclaimer-box {
            background-color: var(--surface);
            border-left: 5px solid var(--error);
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .input-section {
            background-color: var(--surface);
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        input[type="number"], input[type="text"], select {
            width: 100%;
            padding: 12px;
            border: 1px solid #444;
            border-radius: 6px;
            background-color: #2c2c2c;
            color: white;
            font-size: 16px;
        }

        input:focus, select:focus {
            outline: 2px solid var(--primary);
            border-color: transparent;
        }

        button {
            background-color: var(--primary);
            color: white;
            padding: 12px 20px;
            margin-right: 10px;
            margin-top: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        button.secondary {
            background-color: #333;
        }

        button.secondary:hover {
            background-color: #444;
        }

        .results {
            background-color: #1b5e20;
            padding: 25px;
            margin-top: 30px;
            border-radius: 8px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.2);
        }

        .result-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .weekly-plan {
            background-color: #0d47a1;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .week-card {
            background-color: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .references {
            font-size: 0.9em;
            color: #a0a0a0;
            margin-top: 40px;
            padding: 20px;
            background-color: var(--surface);
            border-radius: 8px;
        }

        .compliance-check {
            margin: 20px 0;
            display: flex;
            align-items: center;
        }

        .compliance-check input {
            width: auto;
            margin-right: 10px;
        }

        .status-good {
            color: #4caf50;
        }

        .status-warning {
            color: var(--warning);
        }

        .status-error {
            color: var(--error);
        }

        .drug-card {
            background-color: #0d47a1;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .input-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="disclaimer-box">
        <h2>⚠️ Medical Use Disclaimer</h2>
        <p>This GLP-1 therapy management tool is strictly for educational and informational use only. It is not approved by the FDA for any clinical or diagnostic purposes. No part of this interface should replace licensed medical advice or guide treatment decisions. Consult a licensed healthcare provider before initiating or modifying any treatment based on tool output.</p>
        <p><strong>This is not a medical device under FDA 21 CFR 880.6310.</strong></p>
    </div>

    <div class="compliance-check">
        <input type="checkbox" id="acknowledge" required>
        <label for="acknowledge">I understand this is not for clinical use and results should not guide treatment decisions.</label>
    </div>

    <div class="input-section">
        <h1>GLP-1 Therapy Monitor</h1>

        <div class="input-grid">
            <div class="input-group">
                <label>Age (years)</label>
                <input type="number" id="age" min="18" max="120">
            </div>

            <div class="input-group">
                <label>Sex</label>
                <select id="sex">
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>
            </div>

            <div class="input-group">
                <label>Current Weight (kg)</label>
                <input type="number" id="weight" step="0.1" min="30" max="300">
            </div>

            <div class="input-group">
                <label>Target Weight (kg)</label>
                <input type="number" id="targetWeight" step="0.1" min="30" max="300">
            </div>

            <div class="input-group">
                <label>Height (cm)</label>
                <input type="number" id="height" min="120" max="250">
            </div>

            <div class="input-group">
                <label>Creatinine (mg/dL)</label>
                <input type="number" id="creatinine" step="0.1" min="0.1" max="10">
            </div>

            <div class="input-group">
                <label>Fasting Glucose (mg/dL)</label>
                <input type="number" id="glucose" min="50" max="500">
            </div>

            <div class="input-group">
                <label>Select GLP-1 Medication</label>
                <select id="selectedMed">
                    <option value="semaglutide">Semaglutide (Wegovy®)</option>
                    <option value="liraglutide">Liraglutide (Saxenda®)</option>
                    <option value="tirzepatide">Tirzepatide (Zepbound®)</option>
                </select>
            </div>

            <div class="input-group">
                <label>Current Week of Therapy</label>
                <input type="number" id="currentWeek" min="1" max="20" value="1">
            </div>
        </div>

        <button onclick="calculateAll()">Calculate</button>
        <button class="secondary" onclick="resetForm()">Reset</button>
    </div>

    <div class="results" id="resultsSection" style="display: none;">
        <h3>Results</h3>
        
        <div class="result-item">
            <h4>BMI Analysis</h4>
            <p id="bmiResult"></p>
            <p id="bmiCategory"></p>
        </div>

        <div class="result-item">
            <h4>Weight Management</h4>
            <p id="weightLossResult"></p>
            <p id="weightLossRate"></p>
        </div>

        <div class="result-item">
            <h4>Renal Function</h4>
            <p id="doseAdjustment"></p>
            <p id="renalStatus"></p>
        </div>

        <div class="result-item">
            <h4>Glucose Status</h4>
            <p id="safetyCheck"></p>
            <p id="glucoseStatus"></p>
        </div>

        <div class="result-item">
            <h4>Therapeutic Recommendations</h4>
            <p id="drugRecommendation"></p>
            <div class="drug-card" id="drugDetails"></div>
        </div>

        <div class="weekly-plan">
            <h4>Weekly Treatment Plan</h4>
            <div id="weeklyDoseSchedule"></div>
            <p id="oneWeekTarget"></p>
        </div>
    </div>

    <div class="references">
        <h4>References & Methodology</h4>
        <ol>
            <li>FDA Prescribing Information: Wegovy®, Saxenda®, Zepbound®</li>
            <li>ADA Standards of Medical Care in Diabetes - 2023</li>
            <li>STEP Clinical Trials (Semaglutide)</li>
            <li>SURPASS Clinical Trials (Tirzepatide)</li>
        </ol>
    </div>

    <script>
        // Medication titration schedules
        const medicationTitration = {
            semaglutide: [
                { week: 1, dose: 0.25, targetLoss: 0.5 },
                { week: 2, dose: 0.25, targetLoss: 0.5 },
                { week: 3, dose: 0.5, targetLoss: 0.75 },
                { week: 4, dose: 0.5, targetLoss: 0.75 },
                { week: 5, dose: 1.0, targetLoss: 1.0 },
                { week: 6, dose: 1.0, targetLoss: 1.0 },
                { week: 7, dose: 1.7, targetLoss: 1.0 },
                { week: 8, dose: 1.7, targetLoss: 1.0 },
                { week: 9, dose: 2.4, targetLoss: 1.0 },
                { week: 10, dose: 2.4, targetLoss: 1.0 }
            ],
            liraglutide: [
                { week: 1, dose: 0.6, targetLoss: 0.3 },
                { week: 2, dose: 1.2, targetLoss: 0.5 },
                { week: 3, dose: 1.8, targetLoss: 0.5 },
                { week: 4, dose: 2.4, targetLoss: 0.75 },
                { week: 5, dose: 3.0, targetLoss: 0.75 }
            ],
            tirzepatide: [
                { week: 1, dose: 2.5, targetLoss: 0.5 },
                { week: 2, dose: 2.5, targetLoss: 0.5 },
                { week: 3, dose: 5.0, targetLoss: 0.75 },
                { week: 4, dose: 5.0, targetLoss: 0.75 },
                { week: 5, dose: 7.5, targetLoss: 1.0 },
                { week: 6, dose: 7.5, targetLoss: 1.0 },
                { week: 7, dose: 10.0, targetLoss: 1.0 },
                { week: 8, dose: 10.0, targetLoss: 1.0 },
                { week: 9, dose: 12.5, targetLoss: 1.0 },
                { week: 10, dose: 12.5, targetLoss: 1.0 },
                { week: 11, dose: 15.0, targetLoss: 1.0 },
                { week: 12, dose: 15.0, targetLoss: 1.0 }
            ]
        };

        function calculateAll() {
            if (!document.getElementById('acknowledge').checked) {
                alert("Please acknowledge the disclaimer before proceeding.");
                return;
            }

            // Get all input values
            const age = parseFloat(document.getElementById('age').value);
            const sex = document.getElementById('sex').value;
            const weight = parseFloat(document.getElementById('weight').value);
            const targetWeight = parseFloat(document.getElementById('targetWeight').value);
            const height = parseFloat(document.getElementById('height').value) / 100;
            const creatinine = parseFloat(document.getElementById('creatinine').value);
            const glucose = parseFloat(document.getElementById('glucose').value);
            const selectedMed = document.getElementById('selectedMed').value;
            const currentWeek = parseInt(document.getElementById('currentWeek').value);

            // Validate inputs
            if (!age || !weight || !height || !creatinine || !glucose) {
                alert("Please fill in all required fields.");
                return;
            }

            // Perform calculations
            const bmi = calculateBMI(weight, height);
            const targetBmi = calculateBMI(targetWeight, height);
            const bmiCategory = getBMICategory(bmi);
            const weightLoss = weight - targetWeight;
            const crCl = calculateCrCl(age, weight, creatinine, sex);
            const renalStatus = getRenalStatus(crCl);
            const glucoseStatus = getGlucoseStatus(glucose);
            const recommendation = getDrugRecommendation(crCl, glucose, bmi, selectedMed);

            // Display standard results
            document.getElementById('bmiResult').innerHTML = `Current BMI: <strong>${bmi.toFixed(1)}</strong> | Target BMI: <strong>${targetBmi.toFixed(1)}</strong>`;
            document.getElementById('bmiCategory').innerHTML = `Category: <span class="${getBMIClass(bmi)}">${bmiCategory}</span>`;
            
            document.getElementById('weightLossResult').innerHTML = `Required weight loss: <strong>${weightLoss.toFixed(1)} kg</strong>`;
            document.getElementById('weightLossRate').innerHTML = `Projected timeline: <strong>${Math.round(weightLoss / 0.5)} weeks</strong> at average 0.5kg/week`;
            
            document.getElementById('doseAdjustment').innerHTML = `Creatinine Clearance: <strong>${crCl.toFixed(1)} mL/min</strong>`;
            document.getElementById('renalStatus').innerHTML = `Status: <span class="${getRenalClass(crCl)}">${renalStatus}</span>`;
            
            document.getElementById('safetyCheck').innerHTML = `Fasting Glucose: <strong>${glucose} mg/dL</strong>`;
            document.getElementById('glucoseStatus').innerHTML = `Status: <span class="${getGlucoseClass(glucose)}">${glucoseStatus}</span>`;
            
            document.getElementById('drugRecommendation').innerHTML = `Selected Medication: <strong>${getMedicationName(selectedMed)}</strong>`;
            
            // Generate weekly plan
            generateWeeklyPlan(selectedMed, currentWeek, weight);

            // Show results section
            document.getElementById('resultsSection').style.display = 'block';
        }

        function generateWeeklyPlan(medication, currentWeek, currentWeight) {
            const schedule = medicationTitration[medication];
            const planContainer = document.getElementById('weeklyDoseSchedule');
            planContainer.innerHTML = '';
            
            // Calculate 1-week target based on current week's expected loss
            const currentWeekPlan = schedule[Math.min(currentWeek-1, schedule.length-1)];
            const targetLoss = currentWeekPlan.targetLoss;
            const targetWeight = currentWeight - targetLoss;
            
            document.getElementById('oneWeekTarget').innerHTML = `
                <strong>Next Week Target:</strong> Lose ${targetLoss.toFixed(1)}kg to reach ${targetWeight.toFixed(1)}kg
            `;
            
            // Generate weekly schedule cards
            for (let i = 0; i < schedule.length; i++) {
                const week = schedule[i];
                const weekCard = document.createElement('div');
                weekCard.className = 'week-card';
                
                if (i+1 === currentWeek) {
                    weekCard.style.border = '2px solid var(--warning)';
                    weekCard.style.backgroundColor = 'rgba(255,171,0,0.1)';
                }
                
                weekCard.innerHTML = `
                    <h4>Week ${week.week}${i+1 === currentWeek ? ' (Current)' : ''}</h4>
                    <p>Dose: <strong>${week.dose}mg</strong></p>
                    <p>Target Weight Loss: <strong>${week.targetLoss.toFixed(1)}kg</strong></p>
                `;
                
                planContainer.appendChild(weekCard);
            }
            
            // Add maintenance phase if applicable
            if (currentWeek > schedule.length) {
                const maintenanceCard = document.createElement('div');
                maintenanceCard.className = 'week-card';
                maintenanceCard.style.border = '2px solid var(--primary)';
                maintenanceCard.innerHTML = `
                    <h4>Maintenance Phase (Week ${currentWeek})</h4>
                    <p>Dose: <strong>${schedule[schedule.length-1].dose}mg</strong> (max dose)</p>
                    <p>Target Weight Loss: <strong>0.5kg/week</strong> (sustainable rate)</p>
                `;
                planContainer.appendChild(maintenanceCard);
            }
            
            // Add medication-specific details
            const drugDetails = document.getElementById('drugDetails');
            drugDetails.innerHTML = `
                <h4>${getMedicationName(medication)} Dosing Protocol</h4>
                <p>${getMedicationDetails(medication)}</p>
                <p><strong>Administration:</strong> ${getAdministrationDetails(medication)}</p>
            `;
        }

        function getMedicationName(med) {
            const names = {
                semaglutide: "Semaglutide (Wegovy®)",
                liraglutide: "Liraglutide (Saxenda®)",
                tirzepatide: "Tirzepatide (Zepbound®)"
            };
            return names[med] || med;
        }

        function getMedicationDetails(med) {
            const details = {
                semaglutide: "Weekly subcutaneous injection. Titrate every 4 weeks until reaching maintenance dose of 2.4mg.",
                liraglutide: "Daily subcutaneous injection. Titrate weekly until reaching maintenance dose of 3.0mg.",
                tirzepatide: "Weekly subcutaneous injection. Titrate every 4 weeks until reaching maintenance dose of 15mg."
            };
            return details[med] || "No specific dosing information available.";
        }

        function getAdministrationDetails(med) {
            return med === 'liraglutide' 
                ? "Inject at any time of day, with or without meals" 
                : "Inject once weekly on the same day each week, with or without meals";
        }

        function calculateBMI(weight, height) {
            return weight / (height * height);
        }

        function calculateCrCl(age, weight, creatinine, sex) {
            let crCl = ((140 - age) * weight) / (72 * creatinine);
            if (sex === 'female') crCl *= 0.85;
            return crCl;
        }

        function getBMICategory(bmi) {
            if (bmi < 18.5) return "Underweight";
            if (bmi < 25) return "Normal";
            if (bmi < 30) return "Overweight";
            if (bmi < 35) return "Obesity Class I";
            if (bmi < 40) return "Obesity Class II";
            return "Obesity Class III";
        }

        function getBMIClass(bmi) {
            if (bmi < 18.5) return "status-warning";
            if (bmi < 25) return "status-good";
            if (bmi < 30) return "status-warning";
            return "status-error";
        }

        function getRenalStatus(crCl) {
            if (crCl < 15) return "Kidney Failure";
            if (crCl < 30) return "Severe Impairment (Contraindicated)";
            if (crCl < 60) return "Moderate Impairment (Dose Adjustment Needed)";
            return "Normal Function";
        }

        function getRenalClass(crCl) {
            if (crCl < 30) return "status-error";
            if (crCl < 60) return "status-warning";
            return "status-good";
        }

        function getGlucoseStatus(glucose) {
            if (glucose < 70) return "Hypoglycemia";
            if (glucose < 100) return "Normal";
            if (glucose < 126) return "Prediabetes";
            if (glucose < 200) return "Diabetes (Controlled)";
            return "Diabetes (Poor Control)";
        }

        function getGlucoseClass(glucose) {
            if (glucose < 70) return "status-error";
            if (glucose < 100) return "status-good";
            if (glucose < 126) return "status-warning";
            return "status-error";
        }

        function getDrugRecommendation(crCl, glucose, bmi, selectedMed) {
            if (crCl < 30) {
                return {
                    advice: "Avoid GLP-1 RAs due to severe renal impairment",
                    note: "Contraindicated per FDA labeling"
                };
            }
            return {
                advice: "Proceed with standard titration schedule",
                note: "Monitor for GI side effects during dose escalation"
            };
        }

        function resetForm() {
            document.getElementById('resultsSection').style.display = 'none';
            document.querySelectorAll('input').forEach(input => input.value = '');
            document.getElementById('sex').value = 'male';
            document.getElementById('selectedMed').value = 'semaglutide';
            document.getElementById('currentWeek').value = '1';
        }
    </script>
</body>
</html>
